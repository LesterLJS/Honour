{"ast":null,"code":"import api from './index';\n\n/**\r\n * Upload an image to the server\r\n * @param {File} imageFile - The image file to upload\r\n * @returns {Promise} - API response with the uploaded image data\r\n */\nexport const uploadImage = imageFile => {\n  const formData = new FormData();\n  formData.append('file', imageFile);\n  return api.post('/api/images/upload/', formData, {\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    }\n  });\n};\n\n/**\r\n * Pin a specific image to the local IPFS node\r\n * @param {number} imageId - The ID of the image to pin\r\n * @returns {Promise} - API response with the pin operation results\r\n */\nexport const pinImage = imageId => {\n  return api.post(`/api/images/pin/${imageId}/`);\n};\n\n/**\r\n * Unpin a specific image from the local IPFS node (admin only)\r\n * @param {number} imageId - The ID of the image to unpin\r\n * @returns {Promise} - API response with the unpin operation results\r\n */\nexport const unpinImage = imageId => {\n  return api.post(`/api/images/unpin/${imageId}/`);\n};\n\n/**\r\n * Pin all images uploaded by the current user to the local IPFS node\r\n * @returns {Promise} - API response with the pin operation results\r\n */\nexport const pinAllImages = () => {\n  return api.post('/api/images/pin-all/');\n};\n\n/**\r\n * Run IPFS garbage collection to free up space (admin only)\r\n * @returns {Promise} - API response with the garbage collection results\r\n */\nexport const runGarbageCollection = () => {\n  return api.post('/api/images/run-gc/');\n};\n\n/**\r\n * Run selective IPFS garbage collection based on date range or user (admin only)\r\n * @param {Object} params - Parameters for selective garbage collection\r\n * @param {string} [params.start_date] - Start date in YYYY-MM-DD format\r\n * @param {string} [params.end_date] - End date in YYYY-MM-DD format\r\n * @param {number} [params.user_id] - User ID to filter by\r\n * @returns {Promise} - API response with the garbage collection results\r\n */\nexport const runSelectiveGarbageCollection = params => {\n  return api.post('/api/images/run-selective-gc/', params);\n};\n\n/**\r\n * Get IPFS pin statistics (admin only)\r\n * @param {Object} params - Query parameters\r\n * @param {string} [params.start_date] - Start date in YYYY-MM-DD format\r\n * @param {string} [params.end_date] - End date in YYYY-MM-DD format\r\n * @param {number} [params.user_id] - User ID to filter by\r\n * @returns {Promise} - API response with pin statistics\r\n */\nexport const getIPFSPinStats = (params = {}) => {\n  return api.get('/api/images/analytics/pin-stats/', {\n    params\n  });\n};\n\n/**\r\n * Get all images uploaded by the current user with pagination support\r\n * @param {Object} params - Pagination parameters\r\n * @param {number} [params.page=1] - Page number to fetch\r\n * @param {number} [params.page_size=9] - Number of images per page\r\n * @returns {Promise} - API response with the user's images and pagination info\r\n */\nexport const getMyImages = (params = {\n  page: 1,\n  page_size: 9\n}) => {\n  return api.get('/api/images/my/', {\n    params\n  });\n};\n\n/**\r\n * Get IPFS download link for an image\r\n * @param {number} imageId - The ID of the image\r\n * @returns {Promise} - API response with the IPFS URLs and blockchain data\r\n */\nexport const getImageDownloadLink = async imageId => {\n  try {\n    const response = await api.get(`/api/images/download/${imageId}/`);\n\n    // Return the full response data to allow access to all URLs\n    return response.data;\n  } catch (error) {\n    console.error(\"Failed to get download link:\", error);\n    throw error;\n  }\n};\n\n/**\r\n * Directly download an image file from IPFS through the backend\r\n * @param {number} imageId - The ID of the image to download\r\n * @returns {Promise} - API response with the image file or fallback URL\r\n */\nexport const downloadImageFile = async imageId => {\n  try {\n    // Use responseType 'blob' to handle binary data\n    const response = await api.get(`/api/images/download-file/${imageId}/`, {\n      responseType: 'blob'\n    });\n\n    // Check if the response is JSON (error) or binary (image)\n    const contentType = response.headers['content-type'];\n    if (contentType && contentType.includes('application/json')) {\n      // Parse JSON error response\n      const reader = new FileReader();\n      return new Promise((resolve, reject) => {\n        reader.onload = () => {\n          try {\n            const jsonResponse = JSON.parse(reader.result);\n            resolve(jsonResponse);\n          } catch (e) {\n            reject(new Error('Invalid JSON response'));\n          }\n        };\n        reader.onerror = reject;\n        reader.readAsText(response.data);\n      });\n    } else {\n      // Return the blob for image display\n      return {\n        blob: response.data,\n        contentType: contentType || 'image/jpeg'\n      };\n    }\n  } catch (error) {\n    console.error(\"Failed to download image file:\", error);\n    throw error;\n  }\n};\n\n/**\r\n * Admin: Get all images from all users\r\n * @returns {Promise} - API response with all images\r\n */\nexport const getAllImages = () => {\n  return api.get('/api/images/admin/images/');\n};\n\n/**\r\n * Admin: Delete an image\r\n * @param {number} imageId - The ID of the image to delete\r\n * @returns {Promise} - API response confirming deletion\r\n */\nexport const deleteImage = imageId => {\n  return api.delete(`/api/images/admin/images/${imageId}/`);\n};\n\n/**\r\n * Upload multiple images to the server in a batch\r\n * @param {File[]} imageFiles - Array of image files to upload\r\n * @returns {Promise} - API response with the uploaded images data\r\n */\nexport const batchUploadImages = imageFiles => {\n  const formData = new FormData();\n\n  // Append each file to the formData with the key 'files'\n  imageFiles.forEach(file => {\n    formData.append('files', file);\n  });\n  return api.post('/api/images/batch-upload/', formData, {\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    }\n  });\n};","map":{"version":3,"names":["api","uploadImage","imageFile","formData","FormData","append","post","headers","pinImage","imageId","unpinImage","pinAllImages","runGarbageCollection","runSelectiveGarbageCollection","params","getIPFSPinStats","get","getMyImages","page","page_size","getImageDownloadLink","response","data","error","console","downloadImageFile","responseType","contentType","includes","reader","FileReader","Promise","resolve","reject","onload","jsonResponse","JSON","parse","result","e","Error","onerror","readAsText","blob","getAllImages","deleteImage","delete","batchUploadImages","imageFiles","forEach","file"],"sources":["C:/Users/Erwachens/Desktop/MyProject/frontend/src/api/images.js"],"sourcesContent":["import api from './index';\r\n\r\n/**\r\n * Upload an image to the server\r\n * @param {File} imageFile - The image file to upload\r\n * @returns {Promise} - API response with the uploaded image data\r\n */\r\nexport const uploadImage = (imageFile) => {\r\n  const formData = new FormData();\r\n  formData.append('file', imageFile);\r\n  return api.post('/api/images/upload/', formData, {\r\n    headers: {\r\n      'Content-Type': 'multipart/form-data',\r\n    },\r\n  });\r\n};\r\n\r\n/**\r\n * Pin a specific image to the local IPFS node\r\n * @param {number} imageId - The ID of the image to pin\r\n * @returns {Promise} - API response with the pin operation results\r\n */\r\nexport const pinImage = (imageId) => {\r\n  return api.post(`/api/images/pin/${imageId}/`);\r\n};\r\n\r\n/**\r\n * Unpin a specific image from the local IPFS node (admin only)\r\n * @param {number} imageId - The ID of the image to unpin\r\n * @returns {Promise} - API response with the unpin operation results\r\n */\r\nexport const unpinImage = (imageId) => {\r\n  return api.post(`/api/images/unpin/${imageId}/`);\r\n};\r\n\r\n/**\r\n * Pin all images uploaded by the current user to the local IPFS node\r\n * @returns {Promise} - API response with the pin operation results\r\n */\r\nexport const pinAllImages = () => {\r\n  return api.post('/api/images/pin-all/');\r\n};\r\n\r\n/**\r\n * Run IPFS garbage collection to free up space (admin only)\r\n * @returns {Promise} - API response with the garbage collection results\r\n */\r\nexport const runGarbageCollection = () => {\r\n  return api.post('/api/images/run-gc/');\r\n};\r\n\r\n/**\r\n * Run selective IPFS garbage collection based on date range or user (admin only)\r\n * @param {Object} params - Parameters for selective garbage collection\r\n * @param {string} [params.start_date] - Start date in YYYY-MM-DD format\r\n * @param {string} [params.end_date] - End date in YYYY-MM-DD format\r\n * @param {number} [params.user_id] - User ID to filter by\r\n * @returns {Promise} - API response with the garbage collection results\r\n */\r\nexport const runSelectiveGarbageCollection = (params) => {\r\n  return api.post('/api/images/run-selective-gc/', params);\r\n};\r\n\r\n/**\r\n * Get IPFS pin statistics (admin only)\r\n * @param {Object} params - Query parameters\r\n * @param {string} [params.start_date] - Start date in YYYY-MM-DD format\r\n * @param {string} [params.end_date] - End date in YYYY-MM-DD format\r\n * @param {number} [params.user_id] - User ID to filter by\r\n * @returns {Promise} - API response with pin statistics\r\n */\r\nexport const getIPFSPinStats = (params = {}) => {\r\n  return api.get('/api/images/analytics/pin-stats/', { params });\r\n};\r\n\r\n/**\r\n * Get all images uploaded by the current user with pagination support\r\n * @param {Object} params - Pagination parameters\r\n * @param {number} [params.page=1] - Page number to fetch\r\n * @param {number} [params.page_size=9] - Number of images per page\r\n * @returns {Promise} - API response with the user's images and pagination info\r\n */\r\nexport const getMyImages = (params = { page: 1, page_size: 9 }) => {\r\n  return api.get('/api/images/my/', { params });\r\n};\r\n\r\n/**\r\n * Get IPFS download link for an image\r\n * @param {number} imageId - The ID of the image\r\n * @returns {Promise} - API response with the IPFS URLs and blockchain data\r\n */\r\nexport const getImageDownloadLink = async (imageId) => {\r\n  try {\r\n    const response = await api.get(`/api/images/download/${imageId}/`);\r\n    \r\n    // Return the full response data to allow access to all URLs\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Failed to get download link:\", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Directly download an image file from IPFS through the backend\r\n * @param {number} imageId - The ID of the image to download\r\n * @returns {Promise} - API response with the image file or fallback URL\r\n */\r\nexport const downloadImageFile = async (imageId) => {\r\n  try {\r\n    // Use responseType 'blob' to handle binary data\r\n    const response = await api.get(`/api/images/download-file/${imageId}/`, {\r\n      responseType: 'blob'\r\n    });\r\n    \r\n    // Check if the response is JSON (error) or binary (image)\r\n    const contentType = response.headers['content-type'];\r\n    \r\n    if (contentType && contentType.includes('application/json')) {\r\n      // Parse JSON error response\r\n      const reader = new FileReader();\r\n      return new Promise((resolve, reject) => {\r\n        reader.onload = () => {\r\n          try {\r\n            const jsonResponse = JSON.parse(reader.result);\r\n            resolve(jsonResponse);\r\n          } catch (e) {\r\n            reject(new Error('Invalid JSON response'));\r\n          }\r\n        };\r\n        reader.onerror = reject;\r\n        reader.readAsText(response.data);\r\n      });\r\n    } else {\r\n      // Return the blob for image display\r\n      return {\r\n        blob: response.data,\r\n        contentType: contentType || 'image/jpeg'\r\n      };\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Failed to download image file:\", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n\r\n\r\n/**\r\n * Admin: Get all images from all users\r\n * @returns {Promise} - API response with all images\r\n */\r\nexport const getAllImages = () => {\r\n  return api.get('/api/images/admin/images/');\r\n};\r\n\r\n/**\r\n * Admin: Delete an image\r\n * @param {number} imageId - The ID of the image to delete\r\n * @returns {Promise} - API response confirming deletion\r\n */\r\nexport const deleteImage = (imageId) => {\r\n  return api.delete(`/api/images/admin/images/${imageId}/`);\r\n};\r\n\r\n\r\n/**\r\n * Upload multiple images to the server in a batch\r\n * @param {File[]} imageFiles - Array of image files to upload\r\n * @returns {Promise} - API response with the uploaded images data\r\n */\r\nexport const batchUploadImages = (imageFiles) => {\r\n  const formData = new FormData();\r\n  \r\n  // Append each file to the formData with the key 'files'\r\n  imageFiles.forEach(file => {\r\n    formData.append('files', file);\r\n  });\r\n  \r\n  return api.post('/api/images/batch-upload/', formData, {\r\n    headers: {\r\n      'Content-Type': 'multipart/form-data',\r\n    },\r\n  });\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}